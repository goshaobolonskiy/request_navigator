### Проект для полуавтоматического создания заявок на сайте [навигатор](https://админка82.навигатор.дети/admin/#requests).
Программа реализована на языке Python. Суть программы - автоматизированное заполнение полей нужными данными. Работает это все с помощью имитации нажатий мышью и клавиатурой, а так же анализа экрана.

#### Быстрый старт.
```
win + R -> cmd ->
1. Переход в желаемую директорию
cd C:\Proger
2. Клонирование репозитория
git clone https://github.com/goshaobolonskiy/request_navigator/
3. cd request_navigator
4. pip install -r requirements.txt
5. Запуск программы:
python visual_navigator.py
```
**Если сайт залагал и программа делает не правильные нажатия - закрывайте и перезапускайте**

#### Как работать?
Чтобы программа начала создание заявок, <b>нужно</b> указать <b>направление кружка</b>, <b>группу</b> и <b>заполнить файл</b> `test.txt` списком студентов.
*Обязательно нужно проверить на сайте:*
- Можем ли мы по такому названию кружка попасть в наш кружок 
- Какой по счету идет нужная нам группа на сайте (группа может быть первая, а на сайте в списке будет 2, 3 и т.д.) - указываем какая по счету на сайте.
*Файл* должен быть *заполнен в формате*:
`Фамилия Имя Отчество, год рождения группа`
`Фамилия Имя Отчество, год рождения группа`
Важны только ФИО, но другая информация никак не мешает.
*<b>Браузер должен</b> быть открыт заранее с нужной нам вкладкой и должен находиться в нижней панели Windows n по счету.*
Как мы *все* вышеперечисленное *выполнили*, *можно запускать* выполнение *программы*.
Если вдруг *программа ведет себя не так*, как должна из-за ошибки сайта, *выключайте* ее *и запускайте заново*.

#### Итог работы
- На сайт занеслись все дети, которые нашлись и с которыми не было проблем.
- У нас создается новый файл `result`, который представляет собой переработанный начальный список.
	- Если перед фамилией нет никаких символов, то заявка этого студента была создана успешно.
	- Если перед фамилией стоит `$`, то данного студента нет на сайте и программа не смогла создать заявку с ним.
	- Если перед фамилией стоит `$$$` - нашлось несколько похожих студентов и необходимо руками занести нужного.

#### Что делает программа?
- Переходит в Яндекс
- Далее начинается цикл
	- Начинаем создание заявки
	- Вбиваем данные по заявке и ФИО ребенка
		- Если ребенок нашелся, то создается заявка
		- Если ребенок не нашелся, то поиск продолжается
			- Если ребенка нет, то пропускаем, а в файле отмечаем его символом `$`
			- Если нашлось несколько детей, то пропускаем и отмечаем в файле `$$$`

#### О костылях
- Из-за того, что все работает в зависимости от того, как выглядит экран, <b>важно, чтобы все находилось на своем месте</b> на экране. Я использовал Яндекс в стандартном не измененном от базовых настроек виде.
Пример:
![image](https://github.com/user-attachments/assets/023e68c4-2419-45c0-a6b5-c921052e41a1)

*То на чем я попался - боковое меню(полоска слева). Если ее нет, то программа отработает неверно*

- Так же <b>сайт имеет свойство</b> долго обрабатывать запросы и <b>подвисать</b>. Так как в программе все делается по времени, программа не будет ждать пока сайт подумает и продолжит нажатия. Для этого в программе <b>есть</b> дополнительная <b>переменная</b> `t`, которая <b>увеличивает время задержки</b> между действиями. Рекомендую выставлять до 0.7. Если сайт работает хорошо, то доп. задержка нам не нужна - задержка 0.
